{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","config","clientId","redirectUri","authUrl","responseType","scope","updateUIWithAuthState","hasAuth","$","css","console","log","document","ready","accessToken","Cookies","length","click","appId","tableau","authPurpose","authPurposeEnum","ephemerel","enduring","url","window","location","href","doAuthRedirect","connectionName","submit","myConnector","makeConnector","init","initCallback","authType","authTypeEnum","custom","phase","phaseEnum","authPhase","gatherDataPhase","password","interactivePhase","getSchema","schemaCallback","schema","tableInfo","id","columns","dataType","push","getData","table","doneCallback","dataToReturn","connectionUri","version","getVenueLikesURI","ajax","success","data","response","ii","venues","items","venue","Name","Latitude","lat","Longitude","lng","Address","address","appendRows","abortWithError","error","xhr","ajaxOptions","thrownError","abortForAuth","registerConnector"],"mappings":"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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","(function() {\n  \"use strict\";\n  // This config stores the important strings needed to\n  // connect to the foursquare API and OAuth service\n  //\n  // Storing these here is insecure for a public app\n  // See part II. of this tutorial for an example of how\n  // to do a server-side OAuth flow and avoid this problem\n  var config = {\n    clientId:\n      \"365358090-q5rluaajlfhif5ml3t86tuoc11nmistq.apps.googleusercontent.com\",\n    redirectUri: \"http://localhost:3333/redirect\",\n    authUrl: \"https://accounts.google.com/o/oauth2/v2/auth\",\n    responseType: \"code\",\n    scope: \"profile email\"\n  };\n  console.log(\"test5\");\n\n  // Called when web page first loads and when\n  // the OAuth flow returns to the page\n  //\n  // This function parses the access token in the URI if available\n  // It also adds a link to the foursquare connect button\n  $(document).ready(function() {\n    var accessToken = Cookies.get(\"accessToken\");\n    var hasAuth = accessToken && accessToken.length > 0;\n    updateUIWithAuthState(hasAuth);\n\n    // const queryString = `{allUsers{\n    //                 edges{\n    //                   node{\n    //                     id\n    //                     username\n    //                   }\n    //                 }\n    //               }}`;\n\n    // fetch(\"http://localhost:1337/graphiql\", {\n    //   method: \"POST\",\n    //   headers: {\n    //     \"Content-Type\": \"application/json\",\n    //     Accept: \"application/json\"\n    //   },\n    //   body: JSON.stringify({ query: queryString })\n    // })\n    //   .then(r => r.json())\n    //   .then(data => console.log(\"data returned:\", data))\n    //   .catch(err => console.log(err));\n\n    $(\"#connectbutton\").click(function() {\n      doAuthRedirect();\n    });\n\n    $(\"#getvenuesbutton\").click(function() {\n      tableau.connectionName = \"Foursquare Venues Data\";\n      tableau.submit();\n    });\n  });\n\n  // An on-click function for the connect to foursquare button,\n  // This will redirect the user to a Foursquare login\n  function doAuthRedirect() {\n    var appId = config.clientId;\n    if (tableau.authPurpose === tableau.authPurposeEnum.ephemerel) {\n      appId = config.clientId; // This should be Desktop\n    } else if (tableau.authPurpose === tableau.authPurposeEnum.enduring) {\n      appId = config.clientId; // This should be the Tableau Server appID\n    }\n\n    var url = `${config.authUrl}?response_type=${config.responseType}&client_id=${appId}&redirect_uri=${config.redirectUri}&scope=${config.scope}`;\n    window.location.href = url;\n  }\n\n  //------------- OAuth Helpers -------------//\n  // This helper function returns the URI for the venueLikes endpoint\n  // It appends the passed in accessToken to the call to personalize the call for the user\n  function getVenueLikesURI(accessToken) {\n    return (\n      \"https://api.foursquare.com/v2/users/self/venuelikes?oauth_token=\" +\n      accessToken +\n      \"&v=\" +\n      config.version\n    );\n  }\n\n  // This function toggles the label shown depending\n  // on whether or not the user has been authenticated\n  function updateUIWithAuthState(hasAuth) {\n    if (hasAuth) {\n      $(\".notsignedin\").css(\"display\", \"none\");\n      $(\".signedin\").css(\"display\", \"block\");\n    } else {\n      $(\".notsignedin\").css(\"display\", \"block\");\n      $(\".signedin\").css(\"display\", \"none\");\n    }\n  }\n\n  //------------- Tableau WDC code -------------//\n  // Create tableau connector, should be called first\n  var myConnector = tableau.makeConnector();\n\n  // Init function for connector, called during every phase but\n  // only called when running inside the simulator or tableau\n  myConnector.init = function(initCallback) {\n    tableau.authType = tableau.authTypeEnum.custom;\n\n    // If we are in the auth phase we only want to show the UI needed for auth\n    if (tableau.phase == tableau.phaseEnum.authPhase) {\n      $(\"#getvenuesbutton\").css(\"display\", \"none\");\n    }\n\n    if (tableau.phase == tableau.phaseEnum.gatherDataPhase) {\n      // If the API that WDC is using has an endpoint that checks\n      // the validity of an access token, that could be used here.\n      // Then the WDC can call tableau.abortForAuth if that access token\n      // is invalid.\n    }\n\n    var accessToken = Cookies.get(\"accessToken\");\n    console.log(\"Access token is '\" + accessToken + \"'\");\n    var hasAuth =\n      (accessToken && accessToken.length > 0) || tableau.password.length > 0;\n    updateUIWithAuthState(hasAuth);\n\n    initCallback();\n\n    // If we are not in the data gathering phase, we want to store the token\n    // This allows us to access the token in the data gathering phase\n    if (\n      tableau.phase == tableau.phaseEnum.interactivePhase ||\n      tableau.phase == tableau.phaseEnum.authPhase\n    ) {\n      if (hasAuth) {\n        tableau.password = accessToken;\n\n        if (tableau.phase == tableau.phaseEnum.authPhase) {\n          // Auto-submit here if we are in the auth phase\n          tableau.submit();\n        }\n\n        return;\n      }\n    }\n  };\n\n  // Declare the data to Tableau that we are returning from Foursquare\n  myConnector.getSchema = function(schemaCallback) {\n    var schema = [];\n\n    var col1 = { id: \"Name\", dataType: \"string\" };\n    var col2 = { id: \"Latitude\", dataType: \"float\" };\n    var col3 = { id: \"Longitude\", dataType: \"float\" };\n    var col4 = { id: \"Address\", dataType: \"string\" };\n    var cols = [col1, col2, col3, col4];\n\n    var tableInfo = {\n      id: \"FoursquareTable\",\n      columns: cols\n    };\n\n    schema.push(tableInfo);\n\n    schemaCallback(schema);\n  };\n\n  // This function actually make the foursquare API call and\n  // parses the results and passes them back to Tableau\n  myConnector.getData = function(table, doneCallback) {\n    var dataToReturn = [];\n    var hasMoreData = false;\n\n    var accessToken = tableau.password;\n    var connectionUri = getVenueLikesURI(accessToken);\n\n    var xhr = $.ajax({\n      url: connectionUri,\n      dataType: \"json\",\n      success: function(data) {\n        if (data.response) {\n          var venues = data.response.venues.items;\n\n          var ii;\n          for (ii = 0; ii < venues.length; ++ii) {\n            var venue = {\n              Name: venues[ii].name,\n              Latitude: venues[ii].location.lat,\n              Longitude: venues[ii].location.lng,\n              Address: venues[ii].location.address\n            };\n            dataToReturn.push(venue);\n          }\n\n          table.appendRows(dataToReturn);\n          doneCallback();\n        } else {\n          tableau.abortWithError(\"No results found\");\n        }\n      },\n      error: function(xhr, ajaxOptions, thrownError) {\n        // WDC should do more granular error checking here\n        // or on the server side.  This is just a sample of new API.\n        tableau.abortForAuth(\"Invalid Access Token\");\n      }\n    });\n  };\n\n  // Register the tableau connector, call this last\n  tableau.registerConnector(myConnector);\n})();\n"],"sourceRoot":""}